
local OrionLib = loadstring(game:HttpGet(('https://raw.githubusercontent.com/shlexware/Orion/main/source')))()
local Window = OrionLib:MakeWindow({Name = "PNP_HUB V6.PRO", HidePremium = false, SaveConfig = true, ConfigFolder = "OrionTest"})

local Tab = Window:MakeTab({
    Name = "main",
    Icon = "rbxassetid://4483345998",
    PremiumOnly = false
})
local Section = Tab:AddSection({
    Name = "เมนูฟาร์ม"
})

local function ShowNotification(message)
    OrionLib:MakeNotification({
        Name = "Notification",
        Content = message,
        Image = "rbxassetid://4483345998",
        Time = 5
    })
end

local Players = game:GetService('Players')
local LocalPlayer = Players.LocalPlayer
local VirtualInputManager = game:GetService('VirtualInputManager')

local Enabled = false
local Rod
local Progress = false
local Finished = false

local function CastBait()
    local args = {
        [1] = 100,  -- ตัวอย่างค่า อาจจะมีการปรับตามความต้องการ
        [2] = 1
    }

    local character = LocalPlayer.Character
    if character then
        for _, obj in pairs(character:GetChildren()) do
            if obj:FindFirstChild("events") and obj.events:FindFirstChild("cast") then
                obj.events.cast:FireServer(unpack(args))
                break
            end
        end
    else
        warn("ไม่พบตัวละคร!")
    end
end

Tab:AddToggle({
    Name = "Enable Auto Farm",
    Default = false,
    Callback = function(v)
        Enabled = v
        local GuiService = game:GetService('GuiService')
        local ReplicatedStorage = game:GetService('ReplicatedStorage')

        if not Enabled then
            Finished = false
            Progress = false
            GuiService.SelectedObject = nil

            if Rod then
                Rod.events.reset:FireServer()
            end

            ShowNotification("Auto Farm Disabled")
            return
        end

        ShowNotification("Auto Farm Enabled")

        -- ค้นหาอุปกรณ์ที่มีคำว่า "Rod" ในชื่อ
        local backpack = LocalPlayer.Backpack
        local flimsyRod = nil

        for _, item in ipairs(backpack:GetChildren()) do
            if item:IsA("Tool") and string.find(item.Name, "Rod") then
                flimsyRod = item
                break
            end
        end

        if flimsyRod then
            local args = {
                [1] = flimsyRod
            }
            -- เรียกใช้ event เพื่อ equip อุปกรณ์
            LocalPlayer.PlayerGui.hud.safezone.backpack.events.equip:FireServer(unpack(args))
        else
            warn("ไม่พบ Rod ใน Backpack")
            ShowNotification("ไม่พบ Rod ใน Backpack")
        end

        LocalPlayer.Character.ChildAdded:Connect(function(Child)
            if Child:IsA('Tool') and Child.Name:lower():find('rod') then
                Rod = Child
            end
        end)

        LocalPlayer.Character.ChildRemoved:Connect(function(Child)
            if Child == Rod then
                Finished = false
                Progress = false
                GuiService.SelectedObject = nil
                Rod = nil
            end
        end)

        LocalPlayer.PlayerGui.DescendantAdded:Connect(function(Descendant)
            if Descendant.Name == 'button' and Descendant.Parent.Name == 'safezone' then
                task.wait(0.1)
                GuiService.SelectedObject = Descendant
                VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Return, false, game)
                VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Return, false, game)
            elseif Descendant.Name == 'playerbar' and Descendant.Parent.Name == 'bar' then
                Finished = true
                Descendant:GetPropertyChangedSignal('Position'):Wait()
                ReplicatedStorage.events.reelfinished:FireServer(100, true)
            end
        end)

        LocalPlayer.PlayerGui.DescendantRemoving:Connect(function(Descendant)
            if Descendant.Name == 'reel' then
                Finished = false
                Progress = false
            end
        end)

        -- ลูปที่ทำงานไปเรื่อย ๆ จนกว่า Enable จะถูกปิด
        coroutine.wrap(function()
            while Enabled do
                -- เช็คว่าผู้เล่นถือ Rod หรือไม่
                if not Rod or not LocalPlayer.Character:FindFirstChild(Rod.Name) then
                    local backpack = LocalPlayer.Backpack
                    for _, item in ipairs(backpack:GetChildren()) do
                        if item:IsA("Tool") and string.find(item.Name, "Rod") then
                            local args = {
                                [1] = item
                            }
                            -- เรียกใช้ event เพื่อ equip อุปกรณ์
                            LocalPlayer.PlayerGui.hud.safezone.backpack.events.equip:FireServer(unpack(args))
                            task.wait(1) -- รอเพื่อให้การ equip เสร็จสมบูรณ์
                            break
                        end
                    end
                else
                    -- เช็คว่าเบ็ดได้ถูกโยนหรือยัง
                    if not Progress then
                        Progress = true
                        task.wait(0.5)
                        Rod.events.reset:FireServer()
                        
                        -- เสก bait
                        local args = {
                            [1] = 100,
                            [2] = 1
                        }

                        if LocalPlayer.Character:FindFirstChild("Haunted Rod") then
                            LocalPlayer.Character["Haunted Rod"].events.cast:FireServer(unpack(args))
                        end

                        CastBait()  -- เรียกใช้ฟังก์ชัน CastBait
                    end
                end
                task.wait()
            end
        end)()
        
        local NewRod = LocalPlayer.Character:FindFirstChildWhichIsA('Tool')
        if NewRod and NewRod.Name:lower():find('rod') then
            Rod = NewRod
        end
    end    
})

Tab:AddButton({
    Name = "ขายปลาทั้งหมด",
    Callback = function()
        workspace.world.npcs:FindFirstChild("Marc Merchant").merchant.sellall:InvokeServer()
    end    
})

Tab:AddButton({
    Name = "ขายปลาหนึ่งตัว",
    Callback = function()
        workspace.world.npcs:FindFirstChild("Marc Merchant").merchant.sell:InvokeServer()
    end    
})

local WarpTab = Window:MakeTab({
    Name = "วาร์ปเกาะ",
    Icon = "rbxassetid://4483345998",
    PremiumOnly = false
})

WarpTab:AddButton({
    Name = "Moosewood",
    Callback = function()
        local Tween = game:GetService("TweenService")
        Tween:Create(game.Players.LocalPlayer.Character.HumanoidRootPart, TweenInfo.new(1, Enum.EasingStyle.Linear, Enum.EasingDirection.Out, 0, false, 0),
        {CFrame = CFrame.new(500.488434, 147.40181, 219.991364, -0.564704418, 0, -0.825293183, 0, 1, 0, 0.825293183, 0, -0.564704418)}):Play()
    end    
})

WarpTab:AddButton({
    Name = "ที่เอ็นชาตเบ็ด",
    Callback = function()
        local Tween = game:GetService("TweenService")
        Tween:Create(game.Players.LocalPlayer.Character.HumanoidRootPart, TweenInfo.new(1, Enum.EasingStyle.Linear, Enum.EasingDirection.Out, 0, false, 0),
        {CFrame = CFrame.new(1294.57568, -807.365051, -307.565216, 0.0331695676, 0, 0.99944973, 0, 1, 0, -0.99944973, 0, 0.0331695676)}):Play()
    end    
})

WarpTab:AddButton({
    Name = "Roslit",
    Callback = function()
        local Tween = game:GetService("TweenService")
        Tween:Create(game.Players.LocalPlayer.Character.HumanoidRootPart, TweenInfo.new(1, Enum.EasingStyle.Linear, Enum.EasingDirection.Out, 0, false, 0),
        {CFrame = CFrame.new(-1510.43311, 129.750626, 615.421875, -1, 0, 0, 0, 1, 0, 0, 0, -1)}):Play()
    end    
})

WarpTab:AddButton({
    Name = "Snowcap",
    Callback = function()
        local Tween = game:GetService("TweenService")
        Tween:Create(game.Players.LocalPlayer.Character.HumanoidRootPart, TweenInfo.new(1, Enum.EasingStyle.Linear, Enum.EasingDirection.Out, 0, false, 0),
        {CFrame = CFrame.new(2671.10767, 148.350555, 2388.95117, -0.464032531, -0.044061318, -0.884721994, -0.0204825327, 0.999028802, -0.0390110984, 0.885581613, 1.89337879e-05, -0.464484453)}):Play()
    end    
})

WarpTab:AddButton({
    Name = "Sunstone",
    Callback = function()
        local Tween = game:GetService("TweenService")
        Tween:Create(game.Players.LocalPlayer.Character.HumanoidRootPart, TweenInfo.new(1, Enum.EasingStyle.Linear, Enum.EasingDirection.Out, 0, false, 0),
        {CFrame = CFrame.new(-902.682922, 136.266068, -1128.6886, 0.939700544, -0, -0.341998369, 0, 1, -0, 0.341998369, 0, 0.939700544)}):Play()
    end    
})

WarpTab:AddButton({
    Name = "ถ้ำใต้น้ำวน",
    Callback = function()
        local Tween = game:GetService("TweenService")
        Tween:Create(game.Players.LocalPlayer.Character.HumanoidRootPart, TweenInfo.new(1, Enum.EasingStyle.Linear, Enum.EasingDirection.Out, 0, false, 0),
        {CFrame = CFrame.new(-78.5218506, -482.720367, 1040.32788, -1, 0, 0, 0, 1, 0, 0, 0, -1)}):Play()
    end    
})
