local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/bloodball/-back-ups-for-libs/main/lime"))()

local w = Library:Window("PNP_HUB V6. PRO")

local Enabled = false
local Rod = false
local Progress = false
local Finished = false
local AutoSellEnabled = false  -- ตัวแปรสำหรับการเปิด/ปิด Auto Sell

-- ฟังก์ชันแสดงการแจ้งเตือน
function ShowNotification(String)
    game:GetService('StarterGui'):SetCore('SendNotification', {
        Title = 'Alert!',
        Text = String,
        Duration = 2
    })
end

-- Toggle สำหรับ Auto Shake
w:Toggle("Auto Shake", function(v)
    Enabled = v
    local Players = game:GetService('Players')
    local CoreGui = game:GetService('StarterGui')
    local ReplicatedStorage = game:GetService('ReplicatedStorage')
    local VirtualInputManager = game:GetService('VirtualInputManager')
    local GuiService = game:GetService('GuiService')

    local LocalPlayer = Players.LocalPlayer

    if not Enabled then
        Finished = false
        Progress = false
        GuiService.SelectedObject = nil
        
        if Rod then
            Rod.events.reset:FireServer()
        end
        
        ShowNotification("Auto Farm Disabled")
        return
    end
    
    ShowNotification("Auto Farm Enabled")

    LocalPlayer.Character.ChildAdded:Connect(function(Child)
        if Child:IsA('Tool') and Child.Name:lower():find('rod') then
            Rod = Child
        end
    end)

    LocalPlayer.Character.ChildRemoved:Connect(function(Child)
        if Child == Rod then
            Finished = false
            Progress = false
            GuiService.SelectedObject = nil
            Rod = nil
        end
    end)

    LocalPlayer.PlayerGui.DescendantAdded:Connect(function(Descendant)
        if Descendant.Name == 'button' and Descendant.Parent.Name == 'safezone' then
            task.wait(0.1)
            GuiService.SelectedObject = Descendant
            VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Return, false, game)
            VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Return, false, game)
        elseif Descendant.Name == 'playerbar' and Descendant.Parent.Name == 'bar' then
            Finished = true
            Descendant:GetPropertyChangedSignal('Position'):Wait()
            ReplicatedStorage.events.reelfinished:FireServer(100, true)
        end
    end)

    LocalPlayer.PlayerGui.DescendantRemoving:Connect(function(Descendant)
        if Descendant.Name == 'reel' then
            Finished = false
            Progress = false
        end
    end)

    coroutine.wrap(function()
        while Enabled do
            if not Progress and Rod then
                Progress = true
                task.wait(0.5)
                Rod.events.reset:FireServer()
                Rod.events.cast:FireServer(100.5)
            end
            task.wait()
        end
    end)()

    local NewRod = LocalPlayer.Character:FindFirstChildWhichIsA('Tool')

    if NewRod and NewRod.Name:lower():find('rod') then
        Rod = NewRod
    end
end)

-- Toggle สำหรับ Auto Cast
w:Toggle("Auto Cast", function(v)
    AutoSellEnabled = v
    if AutoSellEnabled then
        ShowNotification("Auto Cast Enabled")

        local args = {
            [1] = 92.59999999999997,
            [2] = 1
        }

        -- Start a loop to continuously cast when Auto Cast is enabled
        coroutine.wrap(function()
            while AutoSellEnabled do
                local localPlayer = game:GetService("Players").LocalPlayer
                local rod = localPlayer.Character:FindFirstChild("Haunted Rod")

                if rod and rod:IsA("Tool") then
                    rod.events.cast:FireServer(unpack(args))
                end
                
                task.wait(1) -- Adjust the wait time as necessary to avoid spamming the cast command
            end
        end)()
    else
        ShowNotification("Auto Cast Disabled")
    end
end)

-- เพิ่มปุ่มใหม่ใน GUI สำหรับขายปลาทั้งหมด
w:Button("ขายปลาทั้งหมด", function()
    print("ขายปลาทั้งหมด ถูกกด!")
    ShowNotification("ขายปลาทั้งหมด ถูกกด!")
    
    -- เรียกใช้คำสั่งขายปลาทั้งหมด
    local merchant = workspace.world.npcs:FindFirstChild("Marc Merchant")
    if merchant and merchant:FindFirstChild("merchant") and merchant.merchant:FindFirstChild("sellall") then
        local success, errorMessage = pcall(function()
            merchant.merchant.sellall:InvokeServer()
        end)
        if success then
            ShowNotification("ขายปลาทั้งหมดเรียบร้อยแล้ว!")
        else
            ShowNotification("เกิดข้อผิดพลาดในการขาย: " .. errorMessage)
        end
    else
        ShowNotification("ไม่พบ Marc Merchant หรือคำสั่งขาย!")
    end
end)

-- เพิ่มปุ่มใหม่อีกปุ่มสำหรับขายปลาตัวเดียว
w:Button("ขายปลาตัวเดียวต้องเลือกปลาก่อน", function()
    print("ขายปลาตัวเดียวถูกกด!")
    ShowNotification("ขายปลาตัวเดียวถูกกด!")
    
    -- ตรวจสอบว่ามี Marc Merchant และคำสั่งขายอยู่หรือไม่
    local merchant = workspace.world.npcs:FindFirstChild("Marc Merchant")
    if merchant and merchant:FindFirstChild("merchant") and merchant.merchant:FindFirstChild("sell") then
        local success, errorMessage = pcall(function()
            merchant.merchant.sell:InvokeServer()
        end)
        if success then
            ShowNotification("ขายปลาตัวเดียวเรียบร้อยแล้ว!")
        else
            ShowNotification("เกิดข้อผิดพลาดในการขาย: " .. errorMessage)
        end
    else
        ShowNotification("ไม่พบ Marc Merchant หรือคำสั่งขาย!")
    end
end)
